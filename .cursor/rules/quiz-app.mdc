---
description: Quiz Application Project Rules
globs: 
alwaysApply: false
---
# Quiz Application Project Rules

## Project Structure
```
quiz-nghiep-vu/
├── index.html          # Main client-side application
├── convert.js          # Excel to JSON conversion script
├── data/              # Generated JSON files directory
│   └── quiz_manifest.json  # Auto-generated quiz manifest
├── quizzes/           # Source Excel files directory
├── README.md          # Project documentation
└── .github/workflows/ # CI/CD configuration files
    ├── release.yml    # Release automation workflow
    └── deploy.yml     # Deployment workflow
```

## Client-Side Application (index.html)

### Core Requirements
- Single-page web application using pure HTML, CSS, and JavaScript
- No external frameworks (React, Vue, Angular)
- Uses canvas-confetti via CDN for visual effects
- Fully client-side, suitable for static hosting
- Progressive Web App (PWA) features with service worker support
- Vietnamese as primary interface language

### Data Structure
- Quiz manifest: `data/quiz_manifest.json`
  ```json
  [
    {
      "name": "Display Name",
      "file": "data/quiz_filename.json",
      "size": 12345 // File size in bytes (for progress indication)
    }
  ]
  ```
- Quiz data files: `data/*.json`
  ```json
  [
    {
      "question": "Question text?",
      "options": ["Option 1", "Option 2", "Option 3", "Option 4"],
      "correctAnswerIndex": 0,
      "source": "Optional source text"
    }
  ]
  ```

### UI Components
- Quiz selection screen with:
  - Quiz list (dropdown menu)
  - Shuffle checkbox
  - Quiz title display
- Quiz interface with:
  - Question display
  - Answer buttons
  - Progress indicator
  - Score display
  - Navigation controls
  - Settings menu
  - Timer functionality
- Results screen with:
  - Final score
  - Performance statistics
  - Confetti effect
  - Action buttons
- Review mode with:
  - Question navigation
  - Answer highlighting
  - Filter toggle (view all questions or only wrong answers)
  - Source display

### State Management
- Uses localStorage (key: 'quizAppState')
- Saves state on significant actions
- Handles session resumption via modal
- Clears state on intentional exit
- In-memory caching to prevent redundant data fetching

### Styling
- Responsive design with media queries
- Light/dark theme using CSS variables
- Persistent theme preference storage
- Clean, modern layout
- Proper spacing and positioning
- Support for Vietnamese character encoding (UTF-8)

## Data Conversion Script (convert.js)

### Dependencies
- Node.js
- xlsx library (`npm install xlsx`)

### Input Format
Excel files in `./quizzes/` with columns:
- A: STT (Optional)
- B: Câu hỏi (Required)
- C: Đáp án 1 (Required)
- D: Đáp án 2 (Required)
- E: Đáp án 3 (Required)
- F: Đáp án 4 (Required)
- G: Đáp án đúng (Required, 1-4)
- H: Trích dẫn nguồn (Optional)

### Processing Rules
- Skip temporary Excel files (~$*)
- Validate required fields
- Convert 1-based to 0-based answer indices
- Handle errors gracefully
- Generate pretty-printed JSON

### Output
- JSON files in `./data/`
- Manifest file: `data/quiz_manifest.json`
- Sorted alphabetically by quiz name
- File size included in manifest for progress indicators

## Optimization Pipeline

### JSON Compression
- Compression script for reduced file sizes
- Command: `npm run compress`

### Asset Optimization
- HTML minification
- CSS minification
- Combined optimization process: `npm run build`

## CI/CD Pipeline

### Release Workflow
- Automatic versioning using semantic versioning
- Changelog generation based on commit messages
- Git tag creation for each release
- Triggered when PRs are merged to main

### Deployment
- Automated deployment to GitHub Pages
- Minification and optimization of assets
- Zero-downtime deployment

## Development Guidelines

### Code Style
- Use meaningful variable names
- Include descriptive comments
- Follow consistent formatting
- Handle errors appropriately
- Use semantic commit messages

### Testing
- Test Excel file processing
- Verify JSON output format
- Check client-side functionality
- Validate state persistence
- Test responsive design

### Performance
- Optimize JSON file sizes
- Minimize DOM operations
- Use efficient event handlers
- Cache DOM references
- Lazy loading of non-essential resources

### Security
- Sanitize user inputs
- Validate file paths
- Handle fetch errors
- Protect against XSS

### Accessibility
- Use semantic HTML
- Provide keyboard navigation
- Include ARIA attributes
- Ensure color contrast

### Browser Support
- Target modern browsers (Chrome, Firefox, Safari, Edge)
- Mobile browsers on iOS and Android
- Use feature detection
- Provide fallbacks
- Progressive enhancement for older browsers

### Offline Support
- Service worker for offline capability
- Client-side caching
- Offline-first approach when possible

### Localization
- UI text and labels in Vietnamese
- Error messages and instructions in Vietnamese
- Date and time formats following Vietnamese conventions

## Future Enhancements (For Reference)
1. Enhanced offline mode with full functionality
2. Enhanced statistics and analytics
3. User accounts and progress tracking
4. Additional quiz formats beyond multiple-choice
5. Modernized tech stack with React and Next.js